
{% extends 'base.html' %}

{% block contenido_cuerpo %}


  <header style="display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;margin-top:1rem;">
    <h1>LISTA DE ART√çCULOS</h1>
    {% if es_moderador %}
      <a href="{% url 'articulos:path_crear_articulo' %}" class="boton-crear-articulo-list">Crear art√≠culo</a>
    {% endif %}
  </header>

  <div style="margin-bottom: 1rem;">
    <span>Ordenar por: </span>
    <a href="?orden=reciente{% if categoria_seleccionada %}&categoria={{ categoria_seleccionada.id }}{% endif %}" class="btn btn-outline {% if orden == 'reciente' %}active{% endif %}">M√°s recientes</a>
    <a href="?orden=antiguo{% if categoria_seleccionada %}&categoria={{ categoria_seleccionada.id }}{% endif %}" class="btn btn-outline {% if orden == 'antiguo' %}active{% endif %}">M√°s antiguos</a>
  </div>

  <section class="posts">
    {% for articulo in articulos %}
      <article>
        {% if articulo.imagen %}
          <div class="image">
            <img src="{{ articulo.imagen.url }}" alt="{{ articulo.nombre }}">
          </div>
        {% endif %}

        <h3>{{ articulo.nombre }}</h3>
        <p>{{ articulo.resumen|truncatechars:180 }}</p>

        <div class="actions">
          <a href="{% url 'articulos:path_detalle_articulo' articulo.pk %}" class="button">Ver m√°s</a>
          {% if es_moderador %}
            <a href="{% url 'articulos:path_editar_articulo' articulo.pk %}" class="button is-success">Editar</a>
            <a href="{% url 'articulos:path_eliminar_articulo' articulo.pk %}" class="button is-danger">Eliminar</a>
          {% endif %}
        </div>
      </article>
    {% empty %}
      <p>No hay art√≠culos publicados todav√≠a‚Ä¶</p>
    {% endfor %}
  </section>

  {# üîπ Paginaci√≥n: fuera del loop #}
  {% if page_obj.has_other_pages %}
    <nav class="paginacion">
      {% if page_obj.has_previous %}
        <a href="?page=1" class="btn btn-outline">¬´ Primero</a>
        <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-outline">‚Äπ Anterior</a>
      {% endif %}

      {% for i in page_obj.paginator.page_range %}
        {% if i == page_obj.number %}
          <span class="btn btn-primary btn-sm">{{ i }}</span>
        {% elif i >= page_obj.number|add:-2 and i <= page_obj.number|add:2 %}
          <a href="?page={{ i }}" class="btn btn-outline btn-sm">{{ i }}</a>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="btn btn-outline">Siguiente ‚Ä∫</a>
        <a href="?page={{ page_obj.paginator.num_pages }}" class="btn btn-outline">√öltima ¬ª</a>
      {% endif %}
    </nav>
  {% endif %}

{% endblock %}
